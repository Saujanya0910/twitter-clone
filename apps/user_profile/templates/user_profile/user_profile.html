{% extends 'core/base.html' %}

{% load humanize %}

  {% block content %}
    <div class="container">
      <div class="columns">
        <div class="column is-12">
          <h1 class="title">
            {{ user.username }}'s Profile
          </h1>

          {% if user.user_profile.avatar %}
            <figure class="image is-128x128">
              <img src="{{ user.user_profile.avatar.url }}" alt="">
            </figure>
          {% endif %}

          <hr>

          <p>
            <!-- link to user's followers list -->
            <a href="{% url 'followers' user.username %}">
              Followers: {{ user.user_profile.followed_by.count }}
            </a>
          </p>
          
          <p>
            <a href="{% url 'followings' user.username %}">
              Following: {{ user.user_profile.follows.count }}
            </a>
          </p>

          {% if user != request.user %}
            {% if request.user.user_profile in user.user_profile.followed_by.all %}
              <a href="{% url 'unfollow_user' user.username %}" class="button is-danger">
                Unfollow
              </a>
            {% else %}
              <a href="{% url 'follow_user' user.username %}" class="button is-success">
                Follow
              </a>
            {% endif %}
          {% endif %}
        </div>
      </div>

      <div class="columns">
        <div class="column is-8">
          <div class="wrapper-tweets">
            {% for tweet in user.tweets.all %}
              <div class="tweet">
                <!-- display all tweets in a container each -->
                <article class="media">
                  <figure class="media-left">
                    <p class="image is-64x64">
                      {% if user.user_profile.avatar %}
                        <img src="{{ user.user_profile.avatar.url }}" alt="">
                      {% endif %}
                    </p>
                  </figure>

                  <div class="media-content">
                    <div class="content">
                      <p>
                        <strong>
                          {{ tweet.created_by.username }}
                        </strong>
                        <small>
                          {{ tweet.created_at|naturaltime }}
                        </small>

                        <br>

                        {{ tweet.body }}
                      </p>
                    </div>
                  </div>
                </article>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  {% endblock %}